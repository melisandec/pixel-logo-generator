generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider   = "postgresql"
  url        = env("DATABASE_URL")
}

model LeaderboardEntry {
  id           String   @id
  text         String
  seed         Int
  imageUrl     String   // Legacy field - use logoImageUrl or cardImageUrl based on context
  logoImageUrl String?  // Raw pixel logo (no frame, no UI, just the art)
  cardImageUrl String?  // Social sharing card (frame, rarity, branding)
  username     String
  displayName  String
  pfpUrl       String
  likes        Int      @default(0)
  recasts      Int      @default(0)
  rarity       String?
  presetKey    String?
  createdAt    DateTime @default(now())
  castUrl      String?

  @@index([createdAt])
  @@index([username])
}

model Badge {
  id          String   @id @default(cuid())
  userId      String
  badgeType   String
  earnedAt    DateTime @default(now())
  metadata    Json?

  @@index([userId])
  @@index([badgeType])
  @@unique([userId, badgeType])
}

model ChallengeCompletion {
  id          String   @id @default(cuid())
  userId      String
  challengeId String
  date        DateTime
  prompts     String[]
  completedAt DateTime @default(now())

  @@unique([userId, challengeId])
  @@index([userId, date])
}

model DailyWinner {
  id            String   @id @default(cuid())
  date          DateTime  @unique
  winner1Id     String
  winner1EntryId String
  winner2Id     String?
  winner2EntryId String?
  winner3Id     String?
  winner3EntryId String?

  @@index([date])
}
